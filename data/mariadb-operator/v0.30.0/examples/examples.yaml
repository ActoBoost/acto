apiVersion: v1
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZGekNDQXYrZ0F3SUJBZ0lVTHZIUkYva0VqcmJSZG43TTBpTnl2ZlFERmNRd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0d6RVpNQmNHQTFVRUF3d1FiV0Z5YVdGa1lpMXZjR1Z5WVhSdmNqQWVGdzB5TkRBMU1ERXdPVEEzTVRoYQpGdzB6TkRBME1qa3dPVEEzTVRoYU1Cc3hHVEFYQmdOVkJBTU1FRzFoY21saFpHSXRiM0JsY21GMGIzSXdnZ0lpCk1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQ0R3QXdnZ0lLQW9JQ0FRQzZTak1HUWhRL00rblZ1dlFHRmhkNkRvOTcKV2Y4Q0ZRbDB2NXV2bG9kYmJZOHR5VHN0ZWxuSTJJUjYvMHhEUUN6aDZtWlh6N204OGhUSDhHQmNTa2pYYnFYaApuL0FFK2FHUUtUZDZNalIzQVQwNkRpSHhMaFFWNEVrd2F1T1ZqblpQc3ovWnl2RXR0UVhnUEg5Wm9laW9LTUhECjZXVWNUYmRPUW4zZzd4ck9NK2Q1Rlp0TXlKZ3ljWkpkRlRhbnZMUCs1K0RsMXZ4d1JwYnMxOHdqczR5RXM1Y2IKTmROMHQ3NjNkQUN2bEZXQmVaN1NDQ1Q2dmRrMnplc2NOWGtFZHVGb1FFSE9zdnRsNmdwcG1hN2xYVExCWjh3eAoxYnlMMjAyU0VMZXZ0ZW93aDFkenE0bEdJR2R0ckg0c1VyU0RUTmZ2T09HOEVlNmJWUWRIREJ1cnBUOW9PNnFDCktma1V5RUJUMU0xbi9GOTdTdVpXUzM4OXl1N3Z1UWJrRVpaZXRKMWdMMXkzMUkzWWcveStaZlVVZjJzZk9iRVgKeG1mcXpnVzJDeGZoS3BRek9UN3VqRGduUWEwaVJmeEpKVWZGazVZcmd6ZzkwQ3ZiTmlGS0xOYmFKVStCNk51bgpVc1VZcTFPWElTN3MveWVGcWlUZnI4enpEYXdlQTcvSDNrUE4rNnE3ZmVFNXAvOVRwU0Q3ejRhQmV6WnRvMTRoCmgrZFlBOXR0WFJOZWZLcGFXMExGWkpmMk1WK3hhdEVUWU9JQ1VDRXBwNkpwWDExcFlKdjdhZGRZM3pOeW1wdnoKVmQyby9iWkhLd3V2SFJwVGcrbi9abkNabHd6NVpINHQzNjdSYlJxN3ZwMEdGbVFKYm1JMUt6UStiVlA2MkFyWQp3RGs3VUFlcnB3dXNEVkVObXdJREFRQUJvMU13VVRBZEJnTlZIUTRFRmdRVUdiNmNlYXdiZnFCdWRXZi8rRFNnCjdZb1Yyb0V3SHdZRFZSMGpCQmd3Rm9BVUdiNmNlYXdiZnFCdWRXZi8rRFNnN1lvVjJvRXdEd1lEVlIwVEFRSC8KQkFVd0F3RUIvekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBZ0VBRzcvTnhMWUV1djl2VU1LQitzSSszR212c1VoUQo2a0NxSkNCMDRnYmx5VjJydFoyYjk4YlpINmdFckVRUjNzQW9BMHRzTSt5QlVCVElObWtSN1pBM2xodXBIcEVFCjVJMUkzWm9aRXdnYzNBanorelVHQmhxdC9CRjlHVmV5UldXWHh2RUI5d2dnOW1NZEo3c0VMOHVQMnVzNkREME4KU3ZUVkJGWmNmc1lzbzNEUHBrSUlpY0VhNXVJaExNVDFjVm9iUG82L1duZWdvUmpCaWVCWUxQdmcxemhCd1NBawpjN1dLOVR5YzNtLzNsWFBQZVV3dUNTa2hUVHlvbjFtcmRvVGlGY2E5cVVDVW44RkNOeDBLRUg5T3ZPeHkwbGhOCjZHYVg0YjFWLy81Z2dDRjVqVVoyOVREbXNGcGdDR0Uyd2Q4RkR4bXZ2WFI0KzZsZTZzUkhaY3QwclVLelQxQlIKbHRQVlRvUjgwY0VuVUFIcE5LTS9MUysvZmlta2Z3M2JFREYzb0VGVnZzWmJNYi9WQzhPaVZVekZ2V3Z1WTlYNQpRTWQ2WkgxVTI2K25ET2NPL1BXa1cxM3h5Y2QyZnZzbkZ1M2dBdGs5Zm5zVWhwU25Da08yRjk5Y2dnZWZ3ZnFDCm9ERjJEMkswcHFwSnk3RllaUVJyeFVJNURlSHYxREF5ampGNHU0T2pWSzF5WEQ5b2x1a295bGdzMlpZNUJwVmoKWlZBSGZBMzk3T05TNm5CdXdpTGJRQ01OdytuSjhCMlV5NStYTmdUdmd1MHVydE5EdXRkMHR2bkZmTFk2RTlrSgpmMGlRdTVCSithS1J2dERVYlhwa1hFRmJTVzFBejFkbVFHNHNzNmFRUmZwYVhzbjh0SmliYTVBQlNUVEdEVmRXCldjcmdab0FnR2FqcVJGQT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
kind: Secret
metadata:
  name: minio-ca
type: Opaque
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-galera
spec:
  galera:
    enabled: true
  livenessProbe:
    initialDelaySeconds: 20
    periodSeconds: 10
    timeoutSeconds: 10
  maxScaleRef:
    name: maxscale-galera
    namespace: maxscale
  metrics:
    enabled: true
  myCnf: '[mariadb]

    bind-address=*

    default_storage_engine=InnoDB

    binlog_format=row

    innodb_autoinc_lock_mode=2

    innodb_buffer_pool_size=1024M

    max_allowed_packet=256M

    '
  readinessProbe:
    initialDelaySeconds: 20
    periodSeconds: 10
    timeoutSeconds: 10
  replicas: 3
  resources:
    limits:
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 128Mi
  rootPasswordSecretKeyRef:
    generate: false
    key: password
    name: mariadb
  storage:
    size: 1Gi
---
apiVersion: v1
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZGekNDQXYrZ0F3SUJBZ0lVTHZIUkYva0VqcmJSZG43TTBpTnl2ZlFERmNRd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0d6RVpNQmNHQTFVRUF3d1FiV0Z5YVdGa1lpMXZjR1Z5WVhSdmNqQWVGdzB5TkRBMU1ERXdPVEEzTVRoYQpGdzB6TkRBME1qa3dPVEEzTVRoYU1Cc3hHVEFYQmdOVkJBTU1FRzFoY21saFpHSXRiM0JsY21GMGIzSXdnZ0lpCk1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQ0R3QXdnZ0lLQW9JQ0FRQzZTak1HUWhRL00rblZ1dlFHRmhkNkRvOTcKV2Y4Q0ZRbDB2NXV2bG9kYmJZOHR5VHN0ZWxuSTJJUjYvMHhEUUN6aDZtWlh6N204OGhUSDhHQmNTa2pYYnFYaApuL0FFK2FHUUtUZDZNalIzQVQwNkRpSHhMaFFWNEVrd2F1T1ZqblpQc3ovWnl2RXR0UVhnUEg5Wm9laW9LTUhECjZXVWNUYmRPUW4zZzd4ck9NK2Q1Rlp0TXlKZ3ljWkpkRlRhbnZMUCs1K0RsMXZ4d1JwYnMxOHdqczR5RXM1Y2IKTmROMHQ3NjNkQUN2bEZXQmVaN1NDQ1Q2dmRrMnplc2NOWGtFZHVGb1FFSE9zdnRsNmdwcG1hN2xYVExCWjh3eAoxYnlMMjAyU0VMZXZ0ZW93aDFkenE0bEdJR2R0ckg0c1VyU0RUTmZ2T09HOEVlNmJWUWRIREJ1cnBUOW9PNnFDCktma1V5RUJUMU0xbi9GOTdTdVpXUzM4OXl1N3Z1UWJrRVpaZXRKMWdMMXkzMUkzWWcveStaZlVVZjJzZk9iRVgKeG1mcXpnVzJDeGZoS3BRek9UN3VqRGduUWEwaVJmeEpKVWZGazVZcmd6ZzkwQ3ZiTmlGS0xOYmFKVStCNk51bgpVc1VZcTFPWElTN3MveWVGcWlUZnI4enpEYXdlQTcvSDNrUE4rNnE3ZmVFNXAvOVRwU0Q3ejRhQmV6WnRvMTRoCmgrZFlBOXR0WFJOZWZLcGFXMExGWkpmMk1WK3hhdEVUWU9JQ1VDRXBwNkpwWDExcFlKdjdhZGRZM3pOeW1wdnoKVmQyby9iWkhLd3V2SFJwVGcrbi9abkNabHd6NVpINHQzNjdSYlJxN3ZwMEdGbVFKYm1JMUt6UStiVlA2MkFyWQp3RGs3VUFlcnB3dXNEVkVObXdJREFRQUJvMU13VVRBZEJnTlZIUTRFRmdRVUdiNmNlYXdiZnFCdWRXZi8rRFNnCjdZb1Yyb0V3SHdZRFZSMGpCQmd3Rm9BVUdiNmNlYXdiZnFCdWRXZi8rRFNnN1lvVjJvRXdEd1lEVlIwVEFRSC8KQkFVd0F3RUIvekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBZ0VBRzcvTnhMWUV1djl2VU1LQitzSSszR212c1VoUQo2a0NxSkNCMDRnYmx5VjJydFoyYjk4YlpINmdFckVRUjNzQW9BMHRzTSt5QlVCVElObWtSN1pBM2xodXBIcEVFCjVJMUkzWm9aRXdnYzNBanorelVHQmhxdC9CRjlHVmV5UldXWHh2RUI5d2dnOW1NZEo3c0VMOHVQMnVzNkREME4KU3ZUVkJGWmNmc1lzbzNEUHBrSUlpY0VhNXVJaExNVDFjVm9iUG82L1duZWdvUmpCaWVCWUxQdmcxemhCd1NBawpjN1dLOVR5YzNtLzNsWFBQZVV3dUNTa2hUVHlvbjFtcmRvVGlGY2E5cVVDVW44RkNOeDBLRUg5T3ZPeHkwbGhOCjZHYVg0YjFWLy81Z2dDRjVqVVoyOVREbXNGcGdDR0Uyd2Q4RkR4bXZ2WFI0KzZsZTZzUkhaY3QwclVLelQxQlIKbHRQVlRvUjgwY0VuVUFIcE5LTS9MUysvZmlta2Z3M2JFREYzb0VGVnZzWmJNYi9WQzhPaVZVekZ2V3Z1WTlYNQpRTWQ2WkgxVTI2K25ET2NPL1BXa1cxM3h5Y2QyZnZzbkZ1M2dBdGs5Zm5zVWhwU25Da08yRjk5Y2dnZWZ3ZnFDCm9ERjJEMkswcHFwSnk3RllaUVJyeFVJNURlSHYxREF5ampGNHU0T2pWSzF5WEQ5b2x1a295bGdzMlpZNUJwVmoKWlZBSGZBMzk3T05TNm5CdXdpTGJRQ01OdytuSjhCMlV5NStYTmdUdmd1MHVydE5EdXRkMHR2bkZmTFk2RTlrSgpmMGlRdTVCSithS1J2dERVYlhwa1hFRmJTVzFBejFkbVFHNHNzNmFRUmZwYVhzbjh0SmliYTVBQlNUVEdEVmRXCldjcmdab0FnR2FqcVJGQT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRZ0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1N3d2dna29BZ0VBQW9JQ0FRQzZTak1HUWhRL00rblYKdXZRR0ZoZDZEbzk3V2Y4Q0ZRbDB2NXV2bG9kYmJZOHR5VHN0ZWxuSTJJUjYvMHhEUUN6aDZtWlh6N204OGhUSAo4R0JjU2tqWGJxWGhuL0FFK2FHUUtUZDZNalIzQVQwNkRpSHhMaFFWNEVrd2F1T1ZqblpQc3ovWnl2RXR0UVhnClBIOVpvZWlvS01IRDZXVWNUYmRPUW4zZzd4ck9NK2Q1Rlp0TXlKZ3ljWkpkRlRhbnZMUCs1K0RsMXZ4d1JwYnMKMTh3anM0eUVzNWNiTmROMHQ3NjNkQUN2bEZXQmVaN1NDQ1Q2dmRrMnplc2NOWGtFZHVGb1FFSE9zdnRsNmdwcAptYTdsWFRMQlo4d3gxYnlMMjAyU0VMZXZ0ZW93aDFkenE0bEdJR2R0ckg0c1VyU0RUTmZ2T09HOEVlNmJWUWRICkRCdXJwVDlvTzZxQ0tma1V5RUJUMU0xbi9GOTdTdVpXUzM4OXl1N3Z1UWJrRVpaZXRKMWdMMXkzMUkzWWcveSsKWmZVVWYyc2ZPYkVYeG1mcXpnVzJDeGZoS3BRek9UN3VqRGduUWEwaVJmeEpKVWZGazVZcmd6ZzkwQ3ZiTmlGSwpMTmJhSlUrQjZOdW5Vc1VZcTFPWElTN3MveWVGcWlUZnI4enpEYXdlQTcvSDNrUE4rNnE3ZmVFNXAvOVRwU0Q3Cno0YUJlelp0bzE0aGgrZFlBOXR0WFJOZWZLcGFXMExGWkpmMk1WK3hhdEVUWU9JQ1VDRXBwNkpwWDExcFlKdjcKYWRkWTN6TnltcHZ6VmQyby9iWkhLd3V2SFJwVGcrbi9abkNabHd6NVpINHQzNjdSYlJxN3ZwMEdGbVFKYm1JMQpLelErYlZQNjJBcll3RGs3VUFlcnB3dXNEVkVObXdJREFRQUJBb0lDQUErU0xZeWxReDR1ZjVCcFdMaml0bThMCmNldkpRdHJxTXdqWGRHWUU4Um9KWU5GNE5zakZwNWdvMEJlY05YZGRLc002L1pFbWJSSWJHTUl0SlJ2N1VmWlkKcXBxcm4vczQ0R1ZiM2pLOUQxbGl1TlNDOEJrb0xydG9MSks2OTY5OWJtd0FBYS81alVveXB6MWhSNHdxSEtyOQpuRlBKczA3MzFUUU5HaVJCVG9USE42dU5aa21kb1lQamV1eTNFUnkvaU5Sc0oreTN6RU94MFM4V01WdEsrNXBWCjgxaFVNNHJYc0lxU3pDaEhUSzMwN3k2YzQzWm1VV01qbm9NdUFLSFZtTWF0ZmVYYndwdDMyNlVtTWhJaTN6bC8KRXhIK0dYT0dBZ2haeDVKWmw1Sk9wYjBtckxCcllmYVZWNGJxc3pZZmprY0ZIRDBybDcyZ1E0UXBRZFFKak5iKwo5TFhvOHBIWWVkbUlRK2JBd1VrNlZyaW1jNWdNRHRjNjk2em5iK09BWXhRUkR2QytRb2ZGVVZKRlRESTc5S2x0CkYxYnRER2xaS3pKVDVsdEtKTlJsYit3WENqSWF4dHFGQmI2dkVyemduZ2RUQzhmeldicXdZV09KMFBIZk50c00KRkhBelV2Y3VSaGFLcUpkelJZMU4ralAvN29LQmJQYzJKbTlVY0xKTlUzQklFS1VUclY2U0F4VUFiRlpZT3pZUgpiUjE5TGkxKzNMQ0lMTDA5RmVDbi82c3ExL0FDc1NDQXhwZFpDdzIwMWpNakdSdjZhTHBQbzIxbzdxNk9zNlhnCno1aTgyclZBZXVMNVRLK0pqZFNKbHM4Vk5jOHJyT0V1M3RDb0tNTVBCMUU5Y0ZwU01VblFmZzF4SXNZOEg3bjEKK3lRUEYzTEZYQ3BNbm1EL28vK2RBb0lCQVFEeFA2U3ByRXlrd0VIN3ExUVU5M2drZmtCcFhaaElxdWoyUS9lbQpEVVZxaEF6Rk0yNjltTmVobldSOHlvWGtzN1kwUlNhdjdQMmRIR0NwWVVtWmdORUwrY3dUNTVnODZNb2dYR0JmCnU4aGdRR1M3ZjFrNkRrQmZuVVZNMlZRdnQ1YW5HSW1vMnE5M1JETjFmdVpaWXNqS3RqVkdibWl6UkJSRS9xWkMKL0NJV1dITnBiSitwVzhOL01iLzlJN3hzQzdGaW9LYWRKTFFtSHQwMHFDN2VyNHN5dnBTUXZuTE8zRDExYmxaSwpuancvQXNwZnNRV211dnVXc1FSTzduakFyMG50bE14OUZjRXlnZDFmSytyOTdZWE9DSUlwMHk3YzlOc0dKeVN0CjBXN1lCQzNqTEpOR2NTeU42VWFja1BHekJocGpWZEpOOWt0R1E4cVFuRUljZFdiTkFvSUJBUURGcmtQNGJiMEgKTGg0d2tjWWxnMUNObWNJOXo0V3pKUVBJa3lQZVU2Uzg1bXEwYngrakpOdGE4SjRLMUdtRTVHZmxxSjZQNlBxUgpLVUF3TnRHM2cwMlZRbzd4dTZRaEduRHVSQi80M1JRRndFMk9LbEx3MXY1bDRvelhKUDZtWEZFMEt3djlzUFlvCmh4NkNDWkkwUEJPdTNlTWR0NU1xVm9MbzMzZDlTUXhSeGZsWkp2QXoxQnBJZkpLeTI1WUdFZTNzaEs4OVlhM1oKNTdlRXJranpOZ2NTTG0vVCt2UDM3cElKTWpsSGFNc2Z0VjVXVFVnKzgwRElFeUtJRWM0T3ZTVjJhcW5KU1dPUgpPdmpiV0R6czR3dDlyQzZSNEJuNC9Ya28xYzdTVGNTeHo3eHR6SG82Qy9WT0lpdUZiM05YNyszK2dUSTNGVFROCkVQdE5FbkpVSERZSEFvSUJBRDZnYSttVURlMXk3MjRhd3VBU2dnRFBPWDlneWFpTG5hQlljcENMdjJwd1R6UmUKTHJCUFhpTFpUZjNMUVVqbWtqVXRnbWFIR2l0UDg1UGs2b3RMMG5qT1p2ai8xUmh5d2czMmpSb3RFRTVVU1JJWApkQjFMRjlENmJjUU9ZdmxrS2xyRVZ2QWJuUk5VQkJ2TFRwY0R1dVpNdUxYSThhc2YwRGM4K0FKSm03dTdTSEtrCnZTbms1WEkrZ3YxKzZtb04rd1dFZU53d2JBZTlXV1ZUQjUvTmFGQkxBeHcwSkcrbzR0ZDZSakptczNNVUVWOFkKQUVTUkk4Q3h3VkdRUEk2Z3NvdFhabUpPWkhIdEhuK1hVaENMT1lJTDJXWnNLUzA0N3liQXdKZlMxM2lDVlRzMQpGaUppUE5PMkxCdDIwUmZOVE1wZXZCSjdEbjEyR2I3Q29iTHJrejBDZ2dFQkFKZlFoTHpXc2xSQVU4a2pPdFIyCmE3ZkR2UXd4UXRIWS9IWGVvcTVNK0hobVVNNXZoUkdLN2JlQ2tTMXFBZnVnV2paaThCcy9acWR5MGF2MWZjdjgKMStsb2ExVTBzUkVIT0hHVCtpWHF5MFM3Y2hSYlpzVTFwN3hoWjU2Vzk4YVZvWHQ2RDhSdVVpMi96MnM0cElMZgpISkt3TDRzVC83NkZJQlp1QUZ0RWJXU2pzU0tKcC9GMTFCV1ZMaWlVUVR3NktzbjVBSWdZYXlhdE1TQ0JwTjY3CndHUnpLMGpXTXVWVzMrcVdHcTAveXJkNFY1SFoya0VXR2N0Ti9yZ1hUSE8vU1hVTzU0UUJpNmp1YkU0d0R1SXkKWUJITTJSc0l5NG1RU0t0V3dIWjhhVEhSZ3ptanpyNmpqbW5LRGpoMDVsVkRtemhZeWxMSlEzcTFydmw2MERqTwpUYU1DZ2dFQUg5WktjTEZ4SGtZTU5xRW9xZzFrN3kyV1o4bXVhZE1WTERPR1hHcThLY2lBSncvY3ArcU11enluClJ2UHNEdCt2ZkdIeWd1NVgwbm5lMmFHS1RLd2FtNGIwMTJlWGF2TVBJV00wNzgybU1HRmw2bGdYUU13eERHNkEKNnFGblFiUnUxdzdwRUQzQytYZG9aT3IyYWpGaXZ2Z3ZUbVQ1Q2JMaWEvQWF4NkVsT0VLbHcydEoxUnN1TnUyMwpKUUFzdUN0eHF5Nnh1SktQamJYR0djUGZTZ3c3aGhCbmR5REo5MmNJSEE1dlFpYWJGM2tRSWZsdVlGRitDMnAwCjM2NVRFM0Q5MW9YQ0hlL1ZRR1J3a01xeHV4NUQ3S3pqdjIvSVIzOGNhc3NZdlVhNmN2RFphM1ljeHVVNUpDZUEKQnJjN3ZrMjFJWmtrU0x3eXhIUmlsWEhNOWJzWFBnPT0KLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLQo=
kind: Secret
metadata:
  name: ca
type: kubernetes.io/tls
---
apiVersion: v1
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZGekNDQXYrZ0F3SUJBZ0lVTHZIUkYva0VqcmJSZG43TTBpTnl2ZlFERmNRd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0d6RVpNQmNHQTFVRUF3d1FiV0Z5YVdGa1lpMXZjR1Z5WVhSdmNqQWVGdzB5TkRBMU1ERXdPVEEzTVRoYQpGdzB6TkRBME1qa3dPVEEzTVRoYU1Cc3hHVEFYQmdOVkJBTU1FRzFoY21saFpHSXRiM0JsY21GMGIzSXdnZ0lpCk1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQ0R3QXdnZ0lLQW9JQ0FRQzZTak1HUWhRL00rblZ1dlFHRmhkNkRvOTcKV2Y4Q0ZRbDB2NXV2bG9kYmJZOHR5VHN0ZWxuSTJJUjYvMHhEUUN6aDZtWlh6N204OGhUSDhHQmNTa2pYYnFYaApuL0FFK2FHUUtUZDZNalIzQVQwNkRpSHhMaFFWNEVrd2F1T1ZqblpQc3ovWnl2RXR0UVhnUEg5Wm9laW9LTUhECjZXVWNUYmRPUW4zZzd4ck9NK2Q1Rlp0TXlKZ3ljWkpkRlRhbnZMUCs1K0RsMXZ4d1JwYnMxOHdqczR5RXM1Y2IKTmROMHQ3NjNkQUN2bEZXQmVaN1NDQ1Q2dmRrMnplc2NOWGtFZHVGb1FFSE9zdnRsNmdwcG1hN2xYVExCWjh3eAoxYnlMMjAyU0VMZXZ0ZW93aDFkenE0bEdJR2R0ckg0c1VyU0RUTmZ2T09HOEVlNmJWUWRIREJ1cnBUOW9PNnFDCktma1V5RUJUMU0xbi9GOTdTdVpXUzM4OXl1N3Z1UWJrRVpaZXRKMWdMMXkzMUkzWWcveStaZlVVZjJzZk9iRVgKeG1mcXpnVzJDeGZoS3BRek9UN3VqRGduUWEwaVJmeEpKVWZGazVZcmd6ZzkwQ3ZiTmlGS0xOYmFKVStCNk51bgpVc1VZcTFPWElTN3MveWVGcWlUZnI4enpEYXdlQTcvSDNrUE4rNnE3ZmVFNXAvOVRwU0Q3ejRhQmV6WnRvMTRoCmgrZFlBOXR0WFJOZWZLcGFXMExGWkpmMk1WK3hhdEVUWU9JQ1VDRXBwNkpwWDExcFlKdjdhZGRZM3pOeW1wdnoKVmQyby9iWkhLd3V2SFJwVGcrbi9abkNabHd6NVpINHQzNjdSYlJxN3ZwMEdGbVFKYm1JMUt6UStiVlA2MkFyWQp3RGs3VUFlcnB3dXNEVkVObXdJREFRQUJvMU13VVRBZEJnTlZIUTRFRmdRVUdiNmNlYXdiZnFCdWRXZi8rRFNnCjdZb1Yyb0V3SHdZRFZSMGpCQmd3Rm9BVUdiNmNlYXdiZnFCdWRXZi8rRFNnN1lvVjJvRXdEd1lEVlIwVEFRSC8KQkFVd0F3RUIvekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBZ0VBRzcvTnhMWUV1djl2VU1LQitzSSszR212c1VoUQo2a0NxSkNCMDRnYmx5VjJydFoyYjk4YlpINmdFckVRUjNzQW9BMHRzTSt5QlVCVElObWtSN1pBM2xodXBIcEVFCjVJMUkzWm9aRXdnYzNBanorelVHQmhxdC9CRjlHVmV5UldXWHh2RUI5d2dnOW1NZEo3c0VMOHVQMnVzNkREME4KU3ZUVkJGWmNmc1lzbzNEUHBrSUlpY0VhNXVJaExNVDFjVm9iUG82L1duZWdvUmpCaWVCWUxQdmcxemhCd1NBawpjN1dLOVR5YzNtLzNsWFBQZVV3dUNTa2hUVHlvbjFtcmRvVGlGY2E5cVVDVW44RkNOeDBLRUg5T3ZPeHkwbGhOCjZHYVg0YjFWLy81Z2dDRjVqVVoyOVREbXNGcGdDR0Uyd2Q4RkR4bXZ2WFI0KzZsZTZzUkhaY3QwclVLelQxQlIKbHRQVlRvUjgwY0VuVUFIcE5LTS9MUysvZmlta2Z3M2JFREYzb0VGVnZzWmJNYi9WQzhPaVZVekZ2V3Z1WTlYNQpRTWQ2WkgxVTI2K25ET2NPL1BXa1cxM3h5Y2QyZnZzbkZ1M2dBdGs5Zm5zVWhwU25Da08yRjk5Y2dnZWZ3ZnFDCm9ERjJEMkswcHFwSnk3RllaUVJyeFVJNURlSHYxREF5ampGNHU0T2pWSzF5WEQ5b2x1a295bGdzMlpZNUJwVmoKWlZBSGZBMzk3T05TNm5CdXdpTGJRQ01OdytuSjhCMlV5NStYTmdUdmd1MHVydE5EdXRkMHR2bkZmTFk2RTlrSgpmMGlRdTVCSithS1J2dERVYlhwa1hFRmJTVzFBejFkbVFHNHNzNmFRUmZwYVhzbjh0SmliYTVBQlNUVEdEVmRXCldjcmdab0FnR2FqcVJGQT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRZ0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1N3d2dna29BZ0VBQW9JQ0FRQzZTak1HUWhRL00rblYKdXZRR0ZoZDZEbzk3V2Y4Q0ZRbDB2NXV2bG9kYmJZOHR5VHN0ZWxuSTJJUjYvMHhEUUN6aDZtWlh6N204OGhUSAo4R0JjU2tqWGJxWGhuL0FFK2FHUUtUZDZNalIzQVQwNkRpSHhMaFFWNEVrd2F1T1ZqblpQc3ovWnl2RXR0UVhnClBIOVpvZWlvS01IRDZXVWNUYmRPUW4zZzd4ck9NK2Q1Rlp0TXlKZ3ljWkpkRlRhbnZMUCs1K0RsMXZ4d1JwYnMKMTh3anM0eUVzNWNiTmROMHQ3NjNkQUN2bEZXQmVaN1NDQ1Q2dmRrMnplc2NOWGtFZHVGb1FFSE9zdnRsNmdwcAptYTdsWFRMQlo4d3gxYnlMMjAyU0VMZXZ0ZW93aDFkenE0bEdJR2R0ckg0c1VyU0RUTmZ2T09HOEVlNmJWUWRICkRCdXJwVDlvTzZxQ0tma1V5RUJUMU0xbi9GOTdTdVpXUzM4OXl1N3Z1UWJrRVpaZXRKMWdMMXkzMUkzWWcveSsKWmZVVWYyc2ZPYkVYeG1mcXpnVzJDeGZoS3BRek9UN3VqRGduUWEwaVJmeEpKVWZGazVZcmd6ZzkwQ3ZiTmlGSwpMTmJhSlUrQjZOdW5Vc1VZcTFPWElTN3MveWVGcWlUZnI4enpEYXdlQTcvSDNrUE4rNnE3ZmVFNXAvOVRwU0Q3Cno0YUJlelp0bzE0aGgrZFlBOXR0WFJOZWZLcGFXMExGWkpmMk1WK3hhdEVUWU9JQ1VDRXBwNkpwWDExcFlKdjcKYWRkWTN6TnltcHZ6VmQyby9iWkhLd3V2SFJwVGcrbi9abkNabHd6NVpINHQzNjdSYlJxN3ZwMEdGbVFKYm1JMQpLelErYlZQNjJBcll3RGs3VUFlcnB3dXNEVkVObXdJREFRQUJBb0lDQUErU0xZeWxReDR1ZjVCcFdMaml0bThMCmNldkpRdHJxTXdqWGRHWUU4Um9KWU5GNE5zakZwNWdvMEJlY05YZGRLc002L1pFbWJSSWJHTUl0SlJ2N1VmWlkKcXBxcm4vczQ0R1ZiM2pLOUQxbGl1TlNDOEJrb0xydG9MSks2OTY5OWJtd0FBYS81alVveXB6MWhSNHdxSEtyOQpuRlBKczA3MzFUUU5HaVJCVG9USE42dU5aa21kb1lQamV1eTNFUnkvaU5Sc0oreTN6RU94MFM4V01WdEsrNXBWCjgxaFVNNHJYc0lxU3pDaEhUSzMwN3k2YzQzWm1VV01qbm9NdUFLSFZtTWF0ZmVYYndwdDMyNlVtTWhJaTN6bC8KRXhIK0dYT0dBZ2haeDVKWmw1Sk9wYjBtckxCcllmYVZWNGJxc3pZZmprY0ZIRDBybDcyZ1E0UXBRZFFKak5iKwo5TFhvOHBIWWVkbUlRK2JBd1VrNlZyaW1jNWdNRHRjNjk2em5iK09BWXhRUkR2QytRb2ZGVVZKRlRESTc5S2x0CkYxYnRER2xaS3pKVDVsdEtKTlJsYit3WENqSWF4dHFGQmI2dkVyemduZ2RUQzhmeldicXdZV09KMFBIZk50c00KRkhBelV2Y3VSaGFLcUpkelJZMU4ralAvN29LQmJQYzJKbTlVY0xKTlUzQklFS1VUclY2U0F4VUFiRlpZT3pZUgpiUjE5TGkxKzNMQ0lMTDA5RmVDbi82c3ExL0FDc1NDQXhwZFpDdzIwMWpNakdSdjZhTHBQbzIxbzdxNk9zNlhnCno1aTgyclZBZXVMNVRLK0pqZFNKbHM4Vk5jOHJyT0V1M3RDb0tNTVBCMUU5Y0ZwU01VblFmZzF4SXNZOEg3bjEKK3lRUEYzTEZYQ3BNbm1EL28vK2RBb0lCQVFEeFA2U3ByRXlrd0VIN3ExUVU5M2drZmtCcFhaaElxdWoyUS9lbQpEVVZxaEF6Rk0yNjltTmVobldSOHlvWGtzN1kwUlNhdjdQMmRIR0NwWVVtWmdORUwrY3dUNTVnODZNb2dYR0JmCnU4aGdRR1M3ZjFrNkRrQmZuVVZNMlZRdnQ1YW5HSW1vMnE5M1JETjFmdVpaWXNqS3RqVkdibWl6UkJSRS9xWkMKL0NJV1dITnBiSitwVzhOL01iLzlJN3hzQzdGaW9LYWRKTFFtSHQwMHFDN2VyNHN5dnBTUXZuTE8zRDExYmxaSwpuancvQXNwZnNRV211dnVXc1FSTzduakFyMG50bE14OUZjRXlnZDFmSytyOTdZWE9DSUlwMHk3YzlOc0dKeVN0CjBXN1lCQzNqTEpOR2NTeU42VWFja1BHekJocGpWZEpOOWt0R1E4cVFuRUljZFdiTkFvSUJBUURGcmtQNGJiMEgKTGg0d2tjWWxnMUNObWNJOXo0V3pKUVBJa3lQZVU2Uzg1bXEwYngrakpOdGE4SjRLMUdtRTVHZmxxSjZQNlBxUgpLVUF3TnRHM2cwMlZRbzd4dTZRaEduRHVSQi80M1JRRndFMk9LbEx3MXY1bDRvelhKUDZtWEZFMEt3djlzUFlvCmh4NkNDWkkwUEJPdTNlTWR0NU1xVm9MbzMzZDlTUXhSeGZsWkp2QXoxQnBJZkpLeTI1WUdFZTNzaEs4OVlhM1oKNTdlRXJranpOZ2NTTG0vVCt2UDM3cElKTWpsSGFNc2Z0VjVXVFVnKzgwRElFeUtJRWM0T3ZTVjJhcW5KU1dPUgpPdmpiV0R6czR3dDlyQzZSNEJuNC9Ya28xYzdTVGNTeHo3eHR6SG82Qy9WT0lpdUZiM05YNyszK2dUSTNGVFROCkVQdE5FbkpVSERZSEFvSUJBRDZnYSttVURlMXk3MjRhd3VBU2dnRFBPWDlneWFpTG5hQlljcENMdjJwd1R6UmUKTHJCUFhpTFpUZjNMUVVqbWtqVXRnbWFIR2l0UDg1UGs2b3RMMG5qT1p2ai8xUmh5d2czMmpSb3RFRTVVU1JJWApkQjFMRjlENmJjUU9ZdmxrS2xyRVZ2QWJuUk5VQkJ2TFRwY0R1dVpNdUxYSThhc2YwRGM4K0FKSm03dTdTSEtrCnZTbms1WEkrZ3YxKzZtb04rd1dFZU53d2JBZTlXV1ZUQjUvTmFGQkxBeHcwSkcrbzR0ZDZSakptczNNVUVWOFkKQUVTUkk4Q3h3VkdRUEk2Z3NvdFhabUpPWkhIdEhuK1hVaENMT1lJTDJXWnNLUzA0N3liQXdKZlMxM2lDVlRzMQpGaUppUE5PMkxCdDIwUmZOVE1wZXZCSjdEbjEyR2I3Q29iTHJrejBDZ2dFQkFKZlFoTHpXc2xSQVU4a2pPdFIyCmE3ZkR2UXd4UXRIWS9IWGVvcTVNK0hobVVNNXZoUkdLN2JlQ2tTMXFBZnVnV2paaThCcy9acWR5MGF2MWZjdjgKMStsb2ExVTBzUkVIT0hHVCtpWHF5MFM3Y2hSYlpzVTFwN3hoWjU2Vzk4YVZvWHQ2RDhSdVVpMi96MnM0cElMZgpISkt3TDRzVC83NkZJQlp1QUZ0RWJXU2pzU0tKcC9GMTFCV1ZMaWlVUVR3NktzbjVBSWdZYXlhdE1TQ0JwTjY3CndHUnpLMGpXTXVWVzMrcVdHcTAveXJkNFY1SFoya0VXR2N0Ti9yZ1hUSE8vU1hVTzU0UUJpNmp1YkU0d0R1SXkKWUJITTJSc0l5NG1RU0t0V3dIWjhhVEhSZ3ptanpyNmpqbW5LRGpoMDVsVkRtemhZeWxMSlEzcTFydmw2MERqTwpUYU1DZ2dFQUg5WktjTEZ4SGtZTU5xRW9xZzFrN3kyV1o4bXVhZE1WTERPR1hHcThLY2lBSncvY3ArcU11enluClJ2UHNEdCt2ZkdIeWd1NVgwbm5lMmFHS1RLd2FtNGIwMTJlWGF2TVBJV00wNzgybU1HRmw2bGdYUU13eERHNkEKNnFGblFiUnUxdzdwRUQzQytYZG9aT3IyYWpGaXZ2Z3ZUbVQ1Q2JMaWEvQWF4NkVsT0VLbHcydEoxUnN1TnUyMwpKUUFzdUN0eHF5Nnh1SktQamJYR0djUGZTZ3c3aGhCbmR5REo5MmNJSEE1dlFpYWJGM2tRSWZsdVlGRitDMnAwCjM2NVRFM0Q5MW9YQ0hlL1ZRR1J3a01xeHV4NUQ3S3pqdjIvSVIzOGNhc3NZdlVhNmN2RFphM1ljeHVVNUpDZUEKQnJjN3ZrMjFJWmtrU0x3eXhIUmlsWEhNOWJzWFBnPT0KLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLQo=
kind: Secret
metadata:
  name: sealed-secrets-key
type: kubernetes.io/tls
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  connection:
    healthCheck:
      interval: 10s
      retryInterval: 3s
    params:
      parseTime: 'true'
    secretName: connection-mariadb
    secretTemplate:
      key: dsn
  database: mariadb
  passwordPlugin:
    pluginArgSecretKeyRef:
      key: passwordHash
      name: mariadb-auth
    pluginNameSecretKeyRef:
      key: nativePasswordPlugin
      name: mariadb-auth
  passwordSecretKeyRef:
    key: password
    name: mariadb
  rootPasswordSecretKeyRef:
    key: password
    name: mariadb
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.20
    type: LoadBalancer
  storage:
    size: 1Gi
  username: mariadb
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-from-nfs
spec:
  bootstrapFrom:
    restoreJob:
      args:
      - --verbose
      metadata:
        labels:
          sidecar.istio.io/inject: 'false'
      resources:
        limits:
          memory: 1Gi
        requests:
          cpu: 100m
          memory: 128Mi
    targetRecoveryTime: 2023-12-19 09:00:00+00:00
    volume:
      nfs:
        path: /volume1/mariadb
        server: nas.local
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  sidecarContainers:
  - args:
    - sleep
    - infinity
    image: busybox:1.36
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  storage:
    size: 1Gi
  suspend: true
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-repl
spec:
  maxScale:
    connection:
      port: 3306
      secretName: mxs-repl-conn
    enabled: true
    guiKubernetesService:
      metadata:
        annotations:
          metallb.universe.tf/loadBalancerIPs: 172.18.0.230
      type: LoadBalancer
    kubernetesService:
      metadata:
        annotations:
          metallb.universe.tf/loadBalancerIPs: 172.18.0.219
      type: LoadBalancer
    metrics:
      enabled: true
  metrics:
    enabled: true
  primaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.130
    type: LoadBalancer
  replicas: 3
  replication:
    enabled: true
  rootPasswordSecretKeyRef:
    key: root-password
    name: mariadb
  secondaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.131
    type: LoadBalancer
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.120
    type: LoadBalancer
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  connection:
    healthCheck:
      interval: 10s
      retryInterval: 3s
    params:
      parseTime: 'true'
    secretName: connection-mariadb
    secretTemplate:
      key: dsn
  database: mariadb
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.20
    type: LoadBalancer
  storage:
    size: 1Gi
  username: mariadb
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-init-mariabackup
spec:
  initContainers:
  - args:
    - mariadb-backup
    - --copy-back
    - --target-dir=/var/mariadb/backup/
    image: docker-registry1.mariadb.com/library/mariadb:11.4.3
  storage:
    size: 1Gi
  volumeMounts:
  - mountPath: /var/mariadb/backup/
    name: mariabackup
  volumes:
  - name: mariabackup
    persistentVolumeClaim:
      claimName: mariabackup
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-from-s3
spec:
  bootstrapFrom:
    restoreJob:
      args:
      - --verbose
      metadata:
        labels:
          sidecar.istio.io/inject: 'false'
      resources:
        limits:
          memory: 1Gi
        requests:
          cpu: 100m
          memory: 128Mi
    s3:
      accessKeyIdSecretKeyRef:
        key: access-key-id
        name: minio
      bucket: backups
      endpoint: minio.minio.svc.cluster.local:9000
      prefix: mariadb
      secretAccessKeySecretKeyRef:
        key: secret-access-key
        name: minio
      tls:
        caSecretKeyRef:
          key: ca.crt
          name: minio-ca
        enabled: true
    targetRecoveryTime: 2023-12-19 09:00:00+00:00
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-galera-from-s3
spec:
  bootstrapFrom:
    restoreJob:
      args:
      - --verbose
      metadata:
        labels:
          sidecar.istio.io/inject: 'false'
      resources:
        limits:
          memory: 1Gi
        requests:
          cpu: 100m
          memory: 128Mi
    s3:
      accessKeyIdSecretKeyRef:
        key: access-key-id
        name: minio
      bucket: backups
      endpoint: minio.minio.svc.cluster.local:9000
      prefix: mariadb
      secretAccessKeySecretKeyRef:
        key: secret-access-key
        name: minio
      tls:
        caSecretKeyRef:
          key: ca.crt
          name: minio-ca
        enabled: true
    targetRecoveryTime: 2023-12-19 09:00:00+00:00
  galera:
    enabled: true
  metrics:
    enabled: true
  primaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.160
    type: LoadBalancer
  replicas: 3
  resources:
    limits:
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 128Mi
  rootPasswordSecretKeyRef:
    key: root-password
    name: mariadb
  secondaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.161
    type: LoadBalancer
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.150
    type: LoadBalancer
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  connection:
    healthCheck:
      interval: 10s
      retryInterval: 3s
    params:
      parseTime: 'true'
    secretName: connection-mariadb
    secretTemplate:
      key: dsn
  database: mariadb
  env:
  - name: TZ
    value: SYSTEM
  image: docker-registry1.mariadb.com/library/mariadb:11.4.3
  imagePullPolicy: IfNotPresent
  imagePullSecrets:
  - name: registry
  livenessProbe:
    exec:
      command:
      - bash
      - -c
      - mariadb -u root -p"${MARIADB_ROOT_PASSWORD}" -e "SELECT 1;"
    initialDelaySeconds: 20
    periodSeconds: 5
    timeoutSeconds: 5
  metrics:
    enabled: true
  myCnf: '[mariadb]

    bind-address=*

    default_storage_engine=InnoDB

    binlog_format=row

    innodb_autoinc_lock_mode=2

    innodb_buffer_pool_size=1024M

    max_allowed_packet=256M

    '
  myCnfConfigMapKeyRef:
    key: my.cnf
    name: mariadb
  passwordSecretKeyRef:
    key: password
    name: mariadb
  podDisruptionBudget:
    maxUnavailable: 50%
  podSecurityContext:
    runAsUser: 0
  port: 3306
  readinessProbe:
    exec:
      command:
      - bash
      - -c
      - mariadb -u root -p"${MARIADB_ROOT_PASSWORD}" -e "SELECT 1;"
    initialDelaySeconds: 20
    periodSeconds: 5
    timeoutSeconds: 5
  resources:
    limits:
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 128Mi
  rootPasswordSecretKeyRef:
    key: root-password
    name: mariadb
  securityContext:
    allowPrivilegeEscalation: false
  service:
    externalTrafficPolicy: Cluster
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.20
    sessionAffinity: None
    type: LoadBalancer
  storage:
    resizeInUseVolumes: true
    size: 1Gi
    storageClassName: standard
    waitForVolumeResize: true
  suspend: false
  timeZone: UTC
  updateStrategy:
    type: ReplicasFirstPrimaryLast
  username: mariadb
  volumeMounts:
  - mountPath: /var/mariadb/backup/
    name: mariabackup
  volumes:
  - name: mariabackup
    persistentVolumeClaim:
      claimName: mariabackup
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-repl
spec:
  metrics:
    enabled: true
  primaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.130
    type: LoadBalancer
  replicas: 3
  replication:
    enabled: true
  rootPasswordSecretKeyRef:
    key: root-password
    name: mariadb
  secondaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.131
    type: LoadBalancer
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.120
    type: LoadBalancer
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-from-pvc
spec:
  bootstrapFrom:
    restoreJob:
      args:
      - --verbose
      metadata:
        labels:
          sidecar.istio.io/inject: 'false'
      resources:
        limits:
          memory: 1Gi
        requests:
          cpu: 100m
          memory: 128Mi
    targetRecoveryTime: 2023-12-19 09:00:00+00:00
    volume:
      persistentVolumeClaim:
        claimName: backup-scheduled
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-galera
spec:
  galera:
    enabled: true
  metrics:
    enabled: true
  primaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.160
    type: LoadBalancer
  replicas: 3
  rootPasswordSecretKeyRef:
    key: root-password
    name: mariadb
  secondaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.161
    type: LoadBalancer
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.150
    type: LoadBalancer
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  myCnf: '[mariadb]

    bind-address=*

    default_storage_engine=InnoDB

    binlog_format=row

    innodb_autoinc_lock_mode=2

    innodb_buffer_pool_size=1024M

    max_allowed_packet=256M'
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-repl
spec:
  affinity:
    antiAffinityEnabled: true
  connection:
    secretName: mariadb-repl-conn
    secretTemplate:
      key: dsn
  database: mariadb
  livenessProbe:
    initialDelaySeconds: 20
    periodSeconds: 5
    timeoutSeconds: 5
  maxScale:
    connection:
      port: 3306
      secretName: mxs-repl-conn
    enabled: true
    kubernetesService:
      metadata:
        annotations:
          metallb.universe.tf/loadBalancerIPs: 172.18.0.219
      type: LoadBalancer
    metrics:
      enabled: true
  metrics:
    enabled: true
  myCnf: '[mariadb]

    bind-address=*

    default_storage_engine=InnoDB

    binlog_format=row

    innodb_autoinc_lock_mode=2

    innodb_buffer_pool_size=1024M

    max_allowed_packet=256M

    '
  passwordSecretKeyRef:
    key: password
    name: mariadb
  podDisruptionBudget:
    maxUnavailable: 33%
  primaryConnection:
    secretName: mariadb-repl-conn-primary
    secretTemplate:
      key: dsn
  primaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.130
    type: LoadBalancer
  readinessProbe:
    initialDelaySeconds: 20
    periodSeconds: 5
    timeoutSeconds: 5
  replicas: 3
  replicasAllowEvenNumber: false
  replication:
    enabled: true
    primary:
      automaticFailover: true
      podIndex: 0
    probesEnabled: true
    replica:
      connectionRetries: 10
      connectionTimeout: 10s
      gtid: CurrentPos
      replPasswordSecretKeyRef:
        key: password
        name: mariadb
      syncTimeout: 10s
      waitPoint: AfterSync
    syncBinlog: true
  resources:
    limits:
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 128Mi
  rootPasswordSecretKeyRef:
    key: root-password
    name: mariadb
  secondaryConnection:
    secretName: mariadb-repl-conn-secondary
    secretTemplate:
      key: dsn
  secondaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.131
    type: LoadBalancer
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.120
    type: LoadBalancer
  storage:
    resizeInUseVolumes: true
    size: 1Gi
    storageClassName: standard
    volumeClaimTemplate:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 1Gi
      storageClassName: standard
    waitForVolumeResize: true
  suspend: false
  timeZone: UTC
  tolerations:
  - effect: NoSchedule
    key: k8s.mariadb.com/ha
    operator: Exists
  updateStrategy:
    type: ReplicasFirstPrimaryLast
  username: mariadb
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-min
spec:
  rootEmptyPassword: true
  storage:
    ephemeral: true
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  metrics:
    enabled: true
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.20
    type: LoadBalancer
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-from-backup
spec:
  bootstrapFrom:
    backupRef:
      name: backup
    restoreJob:
      affinity:
        antiAffinityEnabled: true
      args:
      - --verbose
      metadata:
        labels:
          sidecar.istio.io/inject: 'false'
      resources:
        limits:
          memory: 1Gi
        requests:
          cpu: 100m
          memory: 128Mi
    targetRecoveryTime: 2023-12-19 09:00:00+00:00
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  livenessProbe:
    initialDelaySeconds: 20
    periodSeconds: 5
    timeoutSeconds: 5
  readinessProbe:
    initialDelaySeconds: 20
    periodSeconds: 5
    timeoutSeconds: 5
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  metrics:
    enabled: true
    exporter:
      affinity:
        antiAffinityEnabled: true
      image: prom/mysqld-exporter:v0.15.1
      port: 9104
      resources:
        limits:
          cpu: 300m
          memory: 512Mi
        requests:
          cpu: 50m
          memory: 64Mi
    passwordSecretKeyRef:
      key: password
      name: mariadb
    serviceMonitor:
      interval: 10s
      jobLabel: mariadb-monitoring
      prometheusRelease: kube-prometheus-stack
      scrapeTimeout: 10s
    username: monitoring
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.20
    type: LoadBalancer
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-galera
spec:
  affinity:
    antiAffinityEnabled: true
  connection:
    secretName: mariadb-galera-conn
    secretTemplate:
      key: dsn
  database: mariadb
  galera:
    agent:
      gracefulShutdownTimeout: 1s
      image: docker-registry3.mariadb.com/mariadb-operator/mariadb-operator:v0.0.30
      kubernetesAuth:
        enabled: true
      port: 5555
    availableWhenDonor: false
    config:
      reuseStorageVolume: false
      volumeClaimTemplate:
        accessModes:
        - ReadWriteOnce
        resources:
          requests:
            storage: 300Mi
    enabled: true
    galeraLibPath: /usr/lib/galera/libgalera_smm.so
    initContainer:
      image: docker-registry3.mariadb.com/mariadb-operator/mariadb-operator:v0.0.30
    initJob:
      affinity:
        antiAffinityEnabled: true
      args:
      - --verbose
      metadata:
        labels:
          sidecar.istio.io/inject: 'false'
      resources:
        limits:
          memory: 1Gi
        requests:
          cpu: 100m
          memory: 128Mi
    primary:
      automaticFailover: true
      podIndex: 0
    providerOptions:
      gcs.fc_limit: '64'
    recovery:
      clusterBootstrapTimeout: 10m
      clusterHealthyTimeout: 30s
      clusterMonitorInterval: 10s
      enabled: true
      forceClusterBootstrapInPod: mariadb-galera-0
      job:
        metadata:
          labels:
            sidecar.istio.io/inject: 'false'
        resources:
          limits:
            memory: 256Mi
          requests:
            cpu: 100m
            memory: 128Mi
      minClusterSize: 1
      podRecoveryTimeout: 5m
      podSyncTimeout: 5m
    replicaThreads: 1
    sst: mariabackup
  livenessProbe:
    initialDelaySeconds: 20
    periodSeconds: 5
    timeoutSeconds: 5
  maxScale:
    connection:
      port: 3306
      secretName: mxs-galera-conn
    enabled: true
    kubernetesService:
      metadata:
        annotations:
          metallb.universe.tf/loadBalancerIPs: 172.18.0.229
      type: LoadBalancer
    metrics:
      enabled: true
  metrics:
    enabled: true
  myCnf: '[mariadb]

    bind-address=*

    default_storage_engine=InnoDB

    binlog_format=row

    innodb_autoinc_lock_mode=2

    max_allowed_packet=256M

    '
  passwordSecretKeyRef:
    key: password
    name: mariadb
  podDisruptionBudget:
    maxUnavailable: 33%
  primaryConnection:
    secretName: mariadb-galera-conn-primary
    secretTemplate:
      key: dsn
  primaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.160
    type: LoadBalancer
  readinessProbe:
    initialDelaySeconds: 20
    periodSeconds: 5
    timeoutSeconds: 5
  replicas: 3
  replicasAllowEvenNumber: false
  resources:
    limits:
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 128Mi
  rootPasswordSecretKeyRef:
    key: root-password
    name: mariadb
  secondaryConnection:
    secretName: mariadb-galera-conn-secondary
    secretTemplate:
      key: dsn
  secondaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.161
    type: LoadBalancer
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.150
    type: LoadBalancer
  storage:
    resizeInUseVolumes: true
    size: 1Gi
    storageClassName: standard
    volumeClaimTemplate:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 1Gi
      storageClassName: standard
    waitForVolumeResize: true
  suspend: false
  timeZone: UTC
  tolerations:
  - effect: NoSchedule
    key: k8s.mariadb.com/ha
    operator: Exists
  updateStrategy:
    type: ReplicasFirstPrimaryLast
  username: mariadb
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  inheritMetadata:
    annotations:
      database.myorg.io: mariadb
    labels:
      database.myorg.io: mariadb
  podMetadata:
    annotations:
      sidecar.istio.io/inject: 'false'
    labels:
      sidecar.istio.io/inject: 'false'
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
spec:
  database: mariadb
  metrics:
    enabled: true
  myCnf: '[mariadb]

    bind-address=*

    default_storage_engine=InnoDB

    binlog_format=row

    innodb_autoinc_lock_mode=2

    innodb_buffer_pool_size=1024M

    max_allowed_packet=256M

    '
  passwordSecretKeyRef:
    generate: true
    key: password
    name: mariadb-password
  port: 3306
  resources:
    limits:
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 128Mi
  rootPasswordSecretKeyRef:
    generate: true
    key: password
    name: mariadb-root
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.20
    type: LoadBalancer
  storage:
    size: 1Gi
  username: mariadb
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-galera
spec:
  galera:
    enabled: true
  maxScale:
    connection:
      port: 3306
      secretName: mxs-galera-conn
    enabled: true
    guiKubernetesService:
      metadata:
        annotations:
          metallb.universe.tf/loadBalancerIPs: 172.18.0.231
      type: LoadBalancer
    kubernetesService:
      metadata:
        annotations:
          metallb.universe.tf/loadBalancerIPs: 172.18.0.229
      type: LoadBalancer
    metrics:
      enabled: true
  metrics:
    enabled: true
  primaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.160
    type: LoadBalancer
  replicas: 3
  rootPasswordSecretKeyRef:
    key: root-password
    name: mariadb
  secondaryService:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.161
    type: LoadBalancer
  service:
    metadata:
      annotations:
        metallb.universe.tf/loadBalancerIPs: 172.18.0.150
    type: LoadBalancer
  storage:
    size: 1Gi
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-from-backup-scheduled
spec:
  bootstrapFrom:
    backupRef:
      name: backup-scheduled
    restoreJob:
      affinity:
        antiAffinityEnabled: true
      args:
      - --verbose
      metadata:
        labels:
          sidecar.istio.io/inject: 'false'
      resources:
        limits:
          memory: 1Gi
        requests:
          cpu: 100m
          memory: 128Mi
    targetRecoveryTime: 2023-12-28 09:00:00+00:00
  storage:
    size: 1Gi
---
apiVersion: v1
kind: Secret
metadata:
  name: mariadb-auth
stringData:
  ed25519Hash: LaiG/7DSlQ+t1zlYnMR7he1kSf3u7Hzo2ElLon4mJ4w
  ed25519Plugin: ed25519
  nativePasswordPlugin: mysql_native_password
  passwordHash: '*57685B4F0FF9D049082E296E2C39354B7A98774E'
---
apiVersion: v1
kind: Secret
metadata:
  labels:
    k8s.mariadb.com/watch: ''
  name: maxscale
stringData:
  password: MaxScale11!
---
apiVersion: v1
kind: Secret
metadata:
  labels:
    k8s.mariadb.com/watch: ''
  name: mariadb
stringData:
  password: MariaDB11!
  root-password: MariaDB11!
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb
  namespace: mariadb
spec:
  image:
    pullPolicy: IfNotPresent
    repository: mariadb
    tag: 11.0.3
  port: 3306
  rootPasswordSecretKeyRef:
    key: password
    name: mariadb
  service:
    annotations:
      metallb.universe.tf/loadBalancerIPs: 172.18.0.40
    type: LoadBalancer
  volumeClaimTemplate:
    accessModes:
    - ReadWriteOnce
    resources:
      requests:
        storage: 100Mi
